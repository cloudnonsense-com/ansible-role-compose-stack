{# Universal compose.yml template - iterates over services list #}
---
services:
{% for svc_data in services %}
{% set container_name = stack.name ~ "-" ~ svc_data.name %}
  {{ container_name }}:
{% include "_includes/service_common.j2" %}
{% include "_includes/service_network_mode.j2" %}
{% include "_includes/service_build.j2" %}
{% include "_includes/service_command.j2" %}
{% include "_includes/service_capabilities.j2" %}
{% include "_includes/service_environment.j2" %}
{% include "_includes/service_depends.j2" %}
{% include "_includes/service_logging.j2" %}
{% include "_includes/service_ports.j2" %}
{% include "_includes/service_healthcheck.j2" %}
{% include "_includes/service_labels.j2" %}
{% include "_includes/service_networks.j2" %}
{% include "_includes/service_volumes.j2" %}
{% include "_includes/service_configs.j2" %}

{% endfor %}
{% include "_includes/networks.j2" %}
{% include "_includes/volumes.j2" %}
{% include "_includes/configs.j2" %}
...
